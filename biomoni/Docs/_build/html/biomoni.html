<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>biomoni package &mdash; biomoni 1.01 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> biomoni
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">biomoni package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-biomoni.Experiment">biomoni.Experiment module</a></li>
<li><a class="reference internal" href="#module-biomoni.Model">biomoni.Model module</a></li>
<li><a class="reference internal" href="#module-biomoni.Yeast">biomoni.Yeast module</a></li>
<li><a class="reference internal" href="#module-biomoni.Yeast_variable_feedrate">biomoni.Yeast_variable_feedrate module</a></li>
<li><a class="reference internal" href="#module-biomoni.visualize">biomoni.visualize module</a></li>
<li><a class="reference internal" href="#module-biomoni">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">biomoni</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>biomoni package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/biomoni.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="biomoni-package">
<h1>biomoni package<a class="headerlink" href="#biomoni-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-biomoni.Experiment">
<span id="biomoni-experiment-module"></span><h2>biomoni.Experiment module<a class="headerlink" href="#module-biomoni.Experiment" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="biomoni.Experiment.Experiment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">biomoni.Experiment.</span></span><span class="sig-name descname"><span class="pre">Experiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'metadata.xlsx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'CO2':</span> <span class="pre">'CO2.dat',</span> <span class="pre">'off':</span> <span class="pre">'offline.csv',</span> <span class="pre">'on':</span> <span class="pre">'online.CSV'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_ts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'CO2':</span> <span class="pre">0,</span> <span class="pre">'off':</span> <span class="pre">0,</span> <span class="pre">'on':</span> <span class="pre">0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_csv_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'CO2':</span> <span class="pre">{'encoding':</span> <span class="pre">'unicode_escape',</span> <span class="pre">'header':</span> <span class="pre">0,</span> <span class="pre">'names':</span> <span class="pre">['ts',</span> <span class="pre">'CO2',</span> <span class="pre">'p'],</span> <span class="pre">'sep':</span> <span class="pre">';',</span> <span class="pre">'skiprows':</span> <span class="pre">[0],</span> <span class="pre">'usecols':</span> <span class="pre">[0,</span> <span class="pre">2,</span> <span class="pre">4]},</span> <span class="pre">'off':</span> <span class="pre">{'encoding':</span> <span class="pre">'unicode_escape',</span> <span class="pre">'header':</span> <span class="pre">0,</span> <span class="pre">'sep':</span> <span class="pre">';',</span> <span class="pre">'usecols':</span> <span class="pre">None},</span> <span class="pre">'on':</span> <span class="pre">{'decimal':</span> <span class="pre">',',</span> <span class="pre">'encoding':</span> <span class="pre">'unicode_escape',</span> <span class="pre">'engine':</span> <span class="pre">'python',</span> <span class="pre">'sep':</span> <span class="pre">';',</span> <span class="pre">'skipfooter':</span> <span class="pre">1,</span> <span class="pre">'skiprows':</span> <span class="pre">[1,</span> <span class="pre">2],</span> <span class="pre">'usecols':</span> <span class="pre">None}}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_datetime_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'CO2':</span> <span class="pre">{'errors':</span> <span class="pre">'coerce',</span> <span class="pre">'exact':</span> <span class="pre">False,</span> <span class="pre">'format':</span> <span class="pre">'%d.%m.%Y</span> <span class="pre">%H:%M:%S'},</span> <span class="pre">'off':</span> <span class="pre">{'errors':</span> <span class="pre">'coerce',</span> <span class="pre">'exact':</span> <span class="pre">False,</span> <span class="pre">'format':</span> <span class="pre">'%d.%m.%Y</span> <span class="pre">%H:%M'},</span> <span class="pre">'on':</span> <span class="pre">{'errors':</span> <span class="pre">'coerce',</span> <span class="pre">'exact':</span> <span class="pre">False,</span> <span class="pre">'format':</span> <span class="pre">'%d.%m.%Y</span>&#160; <span class="pre">%H:%M:%S'}}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('on',</span> <span class="pre">'BASET')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_dir_manual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'end1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_excel_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Experiment.Experiment" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for creating an Experiment object with preprocessed datasets e.g. offline(HPLC, bio dry mass), online (MFCS), CO2(Bluesense) data. The class assumes that there is a common path (path) where the whole data and the metadata is present within.
It is assumed that files of the same types e.g. offline are called the same in every subfolder: e.g. the offline files in F1 and F2 (two experiment days - two subfolders in path) are named “offline.csv” in both subfolders. 
It is also asumed that the raw data from types like “offline.csv” is generated by the same device and is thus idenical and requires identical settings to read.
It is also assumed that the Experiment names (sub folder names for experiments) are equal to the experiment names in the metadata index column in order to get the right settings.
If that is not the case and the folder with the measurement data is named differently as the id in metadata or if the directory is not present within path, consider to use exp_dir_manual to give the directory of the measurement data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Path of overarching directory, the metadata.xlsx file and the directories containing the data (e.g. online, offline and CO2) must be within this directory.</p></li>
<li><p><strong>exp_id</strong> (<em>int</em><em> or </em><em>str</em>) – Identifier of the right experiment, must match with index column in metadata.</p></li>
<li><p><strong>meta_path</strong> (<em>str</em>) – metadata file name within path.</p></li>
<li><p><strong>types</strong> (<em>dict</em>) – Dict with measurement data types as keys and file location within path as value.</p></li>
<li><p><strong>index_ts</strong> (<em>None</em><em> or </em><em>dict with ints</em>) – Dict with measurement data types as keys and index of timestamp column in raw data as value.</p></li>
<li><p><strong>read_csv_settings</strong> (<em>None</em><em> or </em><em>dict with settings</em>) – Dict with measurement data types as keys and pd.read_csv settings to read the correspondig raw data to a pd.DataFrame as value.</p></li>
<li><p><strong>to_datetime_settings</strong> – Dict with measurement data types as keys and settings to convert timestamp column in raw data to pd.Timestamp as value.</p></li>
<li><p><strong>calc_rate</strong> (<em>tuple</em>) – column in data frame of typ which should be derived to get the rate.</p></li>
<li><p><strong>exp_dir_manual</strong> (<em>str</em>) – Manually given experiment name (subfolder_name within path), can be used if the experiment identifier (exp_id which is also the index column in metadata) does not match with the folder name, e.g. when folder name is created automatically.</p></li>
<li><p><strong>endpoint</strong> (<em>str</em>) – Name of endpoint column in metadata. Helpful if you have several endpoints in your metadata.</p></li>
<li><p><strong>read_excel_settings</strong> (<em>None</em><em> or </em><em>dict.</em>) – Settings to metadata excel file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Experiment object contaning the measurement data.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Experiment.Experiment.calc_rate">
<span class="sig-name descname"><span class="pre">calc_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dskey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Experiment.Experiment.calc_rate" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the time derivative of a variable with finite differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dskey</strong> (<em>dict key</em>) – Dataset key correspond to one of the measuring types (e.g. “off” , “CO2”)</p></li>
<li><p><strong>col</strong> (<em>str</em>) – Column in dataframe = variable for calculating the rate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New column in dataframe named col_rate = time derivative of col.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Experiment.Experiment.calc_t">
<span class="sig-name descname"><span class="pre">calc_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dskey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Experiment.Experiment.calc_t" title="Permalink to this definition"></a></dt>
<dd><p>Calculates process time as decimal number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dskey</strong> (<em>dict key</em>) – Dataset key correspond to one of the measuring types (e.g. “off” , “CO2”)</p></li>
<li><p><strong>start</strong> (<em>pd.Timestamp</em><em> or </em><em>str</em>) – Timestamp of start point</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Time as decimal number in a new column “t”</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Experiment.Experiment.pop_dataframe">
<span class="sig-name descname"><span class="pre">pop_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">types</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Experiment.Experiment.pop_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Function to delete whole dataframes from the dataset, either of one or several types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>types</strong> (<em>str</em><em> or </em><em>list of str's</em>) – Type of the measurement data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset without specific selected dataframe/s.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Experiment.Experiment.read_data">
<span class="sig-name descname"><span class="pre">read_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_csv_settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_datetime_settings</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Experiment.Experiment.read_data" title="Permalink to this definition"></a></dt>
<dd><p>Function to read the measurement data with the corresponding settings</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param path</dt>
<dd class="field-odd"><p>Path of the measurement data.</p>
</dd>
<dt class="field-even">type path</dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">param index_ts</dt>
<dd class="field-odd"><p>Index of the timestamp column</p>
</dd>
<dt class="field-even">type index_ts</dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">param read_csv_settings</dt>
<dd class="field-odd"><p>Pandas read_csv setings for this type of data.</p>
</dd>
<dt class="field-even">type read_csv_settings</dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">param to_datetime_settings</dt>
<dd class="field-odd"><p>Pandas to_datetime settings to convert timestamp column to pd.Timestamp</p>
</dd>
<dt class="field-even">type to_datetime_settings</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</div></blockquote>
<p>path</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Experiment.Experiment.time_filter">
<span class="sig-name descname"><span class="pre">time_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dskey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Experiment.Experiment.time_filter" title="Permalink to this definition"></a></dt>
<dd><p>Function to filter according to process time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dskey</strong> (<em>dict key</em>) – Dataset key correspond to one of the measuring types (e.g. “off” , “CO2”).</p></li>
<li><p><strong>start</strong> (<em>pd.Timestamp</em><em> or </em><em>str</em>) – Timestamp of start point.</p></li>
<li><p><strong>end</strong> (<em>pd.Timestamp</em><em> or </em><em>str</em>) – Timestamp of end point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Filtered dataframes in dataset.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-biomoni.Model">
<span id="biomoni-model-module"></span><h2>biomoni.Model module<a class="headerlink" href="#module-biomoni.Model" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="biomoni.Model.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">biomoni.Model.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><a class="headerlink" href="#biomoni.Model.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Class Yeast</dt>
<dd class="field-odd"><p>A class to create a basic model, able to estimate.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.change_params">
<span class="sig-name descname"><span class="pre">change_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.change_params" title="Permalink to this definition"></a></dt>
<dd><p>Function to change existing parameter values
:param name: name of the paramater to change 
:type name: str</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.chemical_balancing">
<span class="sig-name descname"><span class="pre">chemical_balancing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.chemical_balancing" title="Permalink to this definition"></a></dt>
<dd><p>Calculate yield coefficients from several metabolic pathways</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.create_settings">
<span class="sig-name descname"><span class="pre">create_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.create_settings" title="Permalink to this definition"></a></dt>
<dd><p>Creates settings required for estimation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'leastsq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'omit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_given</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datasets_dict_given</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings_dict_given</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_solve_ivp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'first_step':</span> <span class="pre">1e-07,</span> <span class="pre">'max_step':</span> <span class="pre">0.1,</span> <span class="pre">'method':</span> <span class="pre">'Radau'}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">fit_kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Function which allows to estimate either directly from the experiments or from manually given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiments</strong> (<em>BioMoni.Experiment.Experiment object</em><em>, </em><em>dict</em><em> or </em><em>list with Experiment objects</em>) – Experiments from which the data are obtained, either single BioMoni.Experiment.Experiment object list or dict with Experiment objects</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Fitting method for lmfit.minimize</p></li>
<li><p><strong>nan_policy</strong> (<em>str</em><em>, </em><em>optional</em>) – Decision on how to deal with nan values in the estimation, method from lmfit.minimize</p></li>
<li><p><strong>p_given</strong> (<em>lmfit.parameter.Parameters object</em>) – Manually given structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>datasets_dict_given</strong> (<em>dict</em>) – Manually given dictionary with key: Experiment number, value: dataset with data from different measurement methods (e.g. off, on CO2 data)</p></li>
<li><p><strong>settings_dict_given</strong> (<em>dict</em>) – <p>Manually given dictionary with settings for the simulation for each given Experiment. Key: Experiment number, value: settings containing:</p>
<ul>
<li><p>y0: Initial state vector</p></li>
<li><p>c: Control variables</p></li>
<li><p>wf: Weighting factors</p></li>
</ul>
</p></li>
<li><p><strong>tau</strong> (<em>float</em><em>, </em><em>int</em><em> or </em><em>None</em>) – decay factor for a weighting factor decrase over time, required in the residuals function.</p></li>
<li><p><strong>kwargs_solve_ivp</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for scipy.integrate.solve_ivp, in form of a dictionary</p></li>
<li><p><strong>**fit_kws</strong> – <p>optional Arguments for lmfit.minimize based on scipy.optimize</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Estimation outcomes (p and yields), estimation duration, simulated and measured data and residuals at the measurement time points, statistics (RMSE, BIAS, STDDEV).</p>
</dd>
</dl>
<p>Everything is saved as object attribute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.get_residuals">
<span class="sig-name descname"><span class="pre">get_residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datasets_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_solve_ivp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.get_residuals" title="Permalink to this definition"></a></dt>
<dd><p>Function that simulates on the measured data time points with given p and yields and calculates the residuals, The experimental data in datasets_dcit and settings must match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
<li><p><strong>settings_dict_given</strong> – <p>Manually given dictionary with settings for the simulation for each given Experiment. Key: Experiment number, value: settings containing:</p>
<ul>
<li><p>y0: Initial state vector</p></li>
<li><p>c: Control variables</p></li>
<li><p>wf: Weighting factors</p></li>
</ul>
</p></li>
<li><p><strong>kwargs_solve_ivp</strong> (<em>dict</em>) – Arguments for scipy.integrate.solve_ivp, in form of a dictionary, should be the same as used in the parameter estimation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.prepare" title="Permalink to this definition"></a></dt>
<dd><p>Function that prepares the data for the estimation, datasets and corresponding settings are extracted from the experiment objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiments</strong> (<em>BioMoni.Experiment.Experiment object</em><em>, </em><em>dict</em><em> or </em><em>list with Experiment objects.</em>) – Experiments from which the data are obtained, either single BioMoni.Experiment.Experiment object list or dict with Experiment objects.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>prepared dataset and settings saved as object attribute.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.report" title="Permalink to this definition"></a></dt>
<dd><p>Function to report fit results</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.set_params" title="Permalink to this definition"></a></dt>
<dd><p>Set the parameters of the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Model.Model.statistics">
<span class="sig-name descname"><span class="pre">statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residuals_dict_all</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Model.Model.statistics" title="Permalink to this definition"></a></dt>
<dd><p>Function which calculates statistics (RMSE, BIAS, STTDEV) for each experiment individually and for all experiments together.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residuals_dict_all</strong> (<em>dict</em>) – Dictionary containing residuals from experiments. Key: Experiment number, value: df with residuals.</p></li>
<li><p><strong>data_types</strong> (<em>list of strings</em>) – type of measurement data e.g. off, on CO2 measurements</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>statistics_single_exp: statistics  for single each experiment, statistics_all_exp: statistics for all experiments simultaneously</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-biomoni.Yeast">
<span id="biomoni-yeast-module"></span><h2>biomoni.Yeast module<a class="headerlink" href="#module-biomoni.Yeast" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">biomoni.Yeast.</span></span><span class="sig-name descname"><span class="pre">Yeast</span></span><a class="headerlink" href="#biomoni.Yeast.Yeast" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#biomoni.Model.Model" title="biomoni.Model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">biomoni.Model.Model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Class Yeast</dt>
<dd class="field-odd"><p>A class to create a yeast model, the class can simulate a yeast fermentation and estimate parameters based on lab data. This class is inherited from the base class: Model.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.calc_CO2">
<span class="sig-name descname"><span class="pre">calc_CO2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.calc_CO2" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates the CO2 pressure in the reactor in vol. % by processing the outcome of the kinetics function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Current time [h]</p></li>
<li><p><strong>y</strong> (<em>array like</em>) – <p>State vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>CO2_percent: CO2 pressure in vol. %</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.calc_mean_pressure">
<span class="sig-name descname"><span class="pre">calc_mean_pressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.calc_mean_pressure" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the CO2 mean pressure in the BlueSens sensor for all time points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A single value: CO2 mean pressure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.calc_weighting_factors">
<span class="sig-name descname"><span class="pre">calc_weighting_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.calc_weighting_factors" title="Permalink to this definition"></a></dt>
<dd><p>Calculates weighting factors from an single experiment: wf(i) = len(“off”) dataset / len(i) dataset for i = “CO2” or “on”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighting factors for single experiment as dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.chemical_balancing">
<span class="sig-name descname"><span class="pre">chemical_balancing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.chemical_balancing" title="Permalink to this definition"></a></dt>
<dd><p>Calculate yield coefficients from p for the following metabolic pathways:</p>
<ol class="arabic simple">
<li><p>(ox) : Oxidative glucose consumption</p></li>
<li><p>(red) : Reductive glucose consumption</p></li>
<li><p>(et) : Ethanol consumption</p></li>
<li><p>(glyc) : Glycerol consumption</p></li>
<li><ol class="loweralpha simple" start="13">
<li><p>: Maintenence metabolism</p></li>
</ol>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>yields: Yields coefficients of metabolic pathways</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.create_controls">
<span class="sig-name descname"><span class="pre">create_controls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.create_controls" title="Permalink to this definition"></a></dt>
<dd><p>Creates controls variables for a single experiment and save them in a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>c: Control variables as dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.create_settings">
<span class="sig-name descname"><span class="pre">create_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.create_settings" title="Permalink to this definition"></a></dt>
<dd><p>Creates settings required for estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>settings: Settings for single experiment as dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.create_y0">
<span class="sig-name descname"><span class="pre">create_y0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.create_y0" title="Permalink to this definition"></a></dt>
<dd><p>Creates initial state vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>y0: Initial state vector as list.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.kinetics">
<span class="sig-name descname"><span class="pre">kinetics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.kinetics" title="Permalink to this definition"></a></dt>
<dd><p>r.h.s. (right hand side) function of the ODE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Current time [h]</p></li>
<li><p><strong>y</strong> (<em>array like</em>) – <p>State vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cS, cX, cE, V, Fin, qsOx, qsRed, muTotal, qe, qCO2, qm: Substance concentrations and kinetic rates at time t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.model_rhs">
<span class="sig-name descname"><span class="pre">model_rhs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.model_rhs" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates the time derivatives to be integrated by solve_ivp by processing the outcome of the kinetics function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Current time [h]</p></li>
<li><p><strong>y</strong> (<em>array like</em>) – <p>State vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dy_dt: Time derivative of state vector.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs_solve_ivp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.observation" title="Permalink to this definition"></a></dt>
<dd><p>The observation function calculates simulated values by processing the outcome of the functions model_rhs and calc_CO2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_grid</strong> (<em>array like</em>) – time grid with measurement time points [h]</p></li>
<li><p><strong>y0</strong> (<em>array like</em>) – <p>Initial state vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
<li><p><strong>**kwargs_solve_ivp</strong> – <p>optional arguments for scipy.integrate.solve_ivp</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sim_exp: Simulated variables for experiment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.residuals">
<span class="sig-name descname"><span class="pre">residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datasets_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_solve_ivp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.residuals" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the residuals between simulated data and measurement data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>datasets_dict</strong> (<em>dict</em>) – Dictionary with key: Experiment number, value: dataset with data from different measurement methods (e.g. off, on CO2 data)</p></li>
<li><p><strong>settings_dict</strong> (<em>dict</em>) – <p>Dictionary with settings for the simulation for each given Experiment. Key: Experiment number, value: settings containing:</p>
<ul>
<li><p>y0: Initial state vector</p></li>
<li><p>c: Control variables</p></li>
<li><p>wf: Weighting factors</p></li>
</ul>
</p></li>
<li><p><strong>kwargs_solve_ivp</strong> (<em>dict</em>) – arguments for scipy.integrate.solve_ivp, coming from the estimate function</p></li>
</ul>
</dd>
</dl>
<p>_return: res_all: Super long residual vector containing the residuals of all experiments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.set_params" title="Permalink to this definition"></a></dt>
<dd><p>Set the parameters of the object, if no parameters are given, the default parameters are set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Fixed parameters and fit parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Set self.p to given p or default p and execute chemical_balancing to calculate yields from p</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast.Yeast.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_solve_ivp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'first_step':</span> <span class="pre">1e-07,</span> <span class="pre">'max_step':</span> <span class="pre">0.1,</span> <span class="pre">'method':</span> <span class="pre">'Radau'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs_solve_ivp_given</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast.Yeast.simulate" title="Permalink to this definition"></a></dt>
<dd><p>Simulates values by calling the observation function, it is possible to simulate manually by using values for t_grid, p, y0 c and yields or via an Experiment object. 
If using an Experiment object, it is still possible to give manual values for  t_grid, p, y0 c. 
Values not given are created from the Experiment object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p></li>
<li><p><strong>t_grid</strong> (<em>array like</em>) – time grid with measurement time points [h]</p></li>
<li><p><strong>y0</strong> (<em>array like</em>) – <p>Initial state vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
<li><p><strong>kwargs_solve_ivp</strong> (<em>dict</em>) – arguments for scipy.integrate.solve_ivp, either standard or coming from the estimate function</p></li>
<li><p><strong>t_step</strong> (<em>int</em><em>, </em><em>optional</em>) – steps for given time interval if t_grid is created from an Experiment object</p></li>
<li><p><strong>endpoint</strong> (<em>str</em>) – Name of endpoint column in metadata, you may choose between different endpoints e.g. end1 and end2. Helpful if you have several endpoints in your metadata</p></li>
<li><p><strong>**kwargs_solve_ivp</strong> – <p>optional arguments for scipy.integrate.solve_ivp</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sim_exp: Simulated data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-biomoni.Yeast_variable_feedrate">
<span id="biomoni-yeast-variable-feedrate-module"></span><h2>biomoni.Yeast_variable_feedrate module<a class="headerlink" href="#module-biomoni.Yeast_variable_feedrate" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">biomoni.Yeast_variable_feedrate.</span></span><span class="sig-name descname"><span class="pre">Yeast_vf</span></span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#biomoni.Model.Model" title="biomoni.Model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">biomoni.Model.Model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Class Yeast</dt>
<dd class="field-odd"><p>A class to create a yeast model, the class can simulate a yeast fermentation and estimate parameters based on lab data. This class is inherited from the base class: Model.</p>
</dd>
</dl>
<p>While Yeast.py was describing a fed batch fermentation with a constant feedrate, this class describes a fed batch fermentation with a changing feedrate over time. Thus there are changes in the function kinetics and create controls campared to Yeast.py.
The values of the changing feedrate where derived from the feed pump power in the MFCS data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.calc_CO2">
<span class="sig-name descname"><span class="pre">calc_CO2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.calc_CO2" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates the CO2 pressure in the reactor in vol. % by processing the outcome of the kinetics function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Current time [h]</p></li>
<li><p><strong>y</strong> (<em>array like</em>) – <p>State vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>CO2_percent: CO2 pressure in vol. %</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.calc_mean_pressure">
<span class="sig-name descname"><span class="pre">calc_mean_pressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.calc_mean_pressure" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the CO2 mean pressure in the BlueSens sensor for all time points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A single value: CO2 mean pressure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.calc_weighting_factors">
<span class="sig-name descname"><span class="pre">calc_weighting_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.calc_weighting_factors" title="Permalink to this definition"></a></dt>
<dd><p>Calculates weighting factors from an single experiment: e.g. wf(i) = len(“off”) dataset / len(i) dataset for i = “CO2” or “on”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighting factors for single experiment as dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.chemical_balancing">
<span class="sig-name descname"><span class="pre">chemical_balancing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.chemical_balancing" title="Permalink to this definition"></a></dt>
<dd><p>Calculate yield coefficients from p for the following metabolic pathways:</p>
<ol class="arabic simple">
<li><p>(ox) : Oxidative glucose consumption</p></li>
<li><p>(red) : Reductive glucose consumption</p></li>
<li><p>(et) : Ethanol consumption</p></li>
<li><p>(glyc) : Glycerol consumption</p></li>
<li><ol class="loweralpha simple" start="13">
<li><p>: Maintenence metabolism</p></li>
</ol>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>yields: Yields coefficients of metabolic pathways</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.create_controls">
<span class="sig-name descname"><span class="pre">create_controls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.create_controls" title="Permalink to this definition"></a></dt>
<dd><p>Creates control variables for a single experiment and save them in a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>c: Control variables as dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.create_settings">
<span class="sig-name descname"><span class="pre">create_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.create_settings" title="Permalink to this definition"></a></dt>
<dd><p>Creates settings required for estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>settings: Settings for single experiment as dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.create_y0">
<span class="sig-name descname"><span class="pre">create_y0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.create_y0" title="Permalink to this definition"></a></dt>
<dd><p>Creates initial state vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>y0: Initial state vector as list.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.kinetics">
<span class="sig-name descname"><span class="pre">kinetics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.kinetics" title="Permalink to this definition"></a></dt>
<dd><p>r.h.s. (right hand side) function of the ODE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Current time [h]</p></li>
<li><p><strong>y</strong> (<em>array like</em>) – <p>State vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cS, cX, cE, V, Fin, qsOx, qsRed, muTotal, qe, qCO2, qm: Substance concentrations and kinetic rates at time t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.model_rhs">
<span class="sig-name descname"><span class="pre">model_rhs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.model_rhs" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates the time derivatives to be integrated by solve_ivp by processing the outcome of the kinetics function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Current time [h]</p></li>
<li><p><strong>y</strong> (<em>array like</em>) – <p>State vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dy_dt: Time derivative of state vector.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs_solve_ivp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.observation" title="Permalink to this definition"></a></dt>
<dd><p>The observation function calculates simulated values by processing the outcome of the functions model_rhs and calc_CO2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_grid</strong> (<em>array like</em>) – time grid with measurement time points [h]</p></li>
<li><p><strong>y0</strong> (<em>array like</em>) – <p>Initial state vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
<li><p><strong>**kwargs_solve_ivp</strong> – <p>optional arguments for scipy.integrate.solve_ivp</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sim_exp: Simulated variables for experiment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.residuals">
<span class="sig-name descname"><span class="pre">residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datasets_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_solve_ivp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.residuals" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the residuals between simulated data and measurement data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>datasets_dict</strong> (<em>dict</em>) – Dictionary with key: Experiment number, value: dataset with data from different measurement methods (e.g. off, on CO2 data)</p></li>
<li><p><strong>settings_dict</strong> (<em>dict</em>) – <p>Dictionary with settings for the simulation for each given Experiment. Key: Experiment number, value: settings containing:</p>
<ul>
<li><p>y0: Initial state vector</p></li>
<li><p>c: Control variables</p></li>
<li><p>wf: Weighting factors</p></li>
</ul>
</p></li>
<li><p><strong>kwargs_solve_ivp</strong> (<em>dict</em>) – arguments for scipy.integrate.solve_ivp, coming from the estimate function</p></li>
</ul>
</dd>
</dl>
<p>_return: res_all: Super long residual vector containing the residuals of all experiments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.set_params" title="Permalink to this definition"></a></dt>
<dd><p>Set the parameters of the object, if no parameters are given, the default parameters are set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Fixed parameters and fit parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Set self.p to given p or default p and execute chemical_balancing to calculate yields from p</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biomoni.Yeast_variable_feedrate.Yeast_vf.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_solve_ivp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'first_step':</span> <span class="pre">1e-07,</span> <span class="pre">'max_step':</span> <span class="pre">0.1,</span> <span class="pre">'method':</span> <span class="pre">'Radau'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs_solve_ivp_given</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.Yeast_variable_feedrate.Yeast_vf.simulate" title="Permalink to this definition"></a></dt>
<dd><p>Simulates values by calling the observation function, it is possible to simulate manually by using values for t_grid, p, y0 c and yields or via an Experiment object. 
If using an Experiment object, it is still possible to give manual values for  t_grid, p, y0 c. 
Values not given are created from the Experiment object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<em>BioMoni.Experiment.Experiment</em>) – Experiment object</p></li>
<li><p><strong>t_grid</strong> (<em>array like</em>) – time grid with measurement time points [h]</p></li>
<li><p><strong>y0</strong> (<em>array like</em>) – <p>Initial state vector:</p>
<ul>
<li><p>y[0] : Substrate mass (mS) [g]</p></li>
<li><p>y[1] : Bio dry mass (mX) [g]</p></li>
<li><p>y[2] : Ethanol mass (mE) [g]</p></li>
<li><p>y[3] : Volume of fermentation broth [L]</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<em>lmfit.parameter.Parameters object</em>) – Structure with parameter values to be estimated, cf. lmfit.parameter.Parameters</p></li>
<li><p><strong>c</strong> (<em>dict</em>) – <p>Dictionary with control values</p>
<ul>
<li><p>c[“feed_on”]: Time point when feed was switched on [h]</p></li>
<li><p>c[“feed_rate”]: Feed rate [L/h]</p></li>
<li><p>c[“csf”]: Substrate concentration in feed [g/L]</p></li>
<li><p>c[“M_base”]: Base concentration [mol/L]</p></li>
<li><p>c[“gas_flow”]: Aeration rate [L/h]</p></li>
<li><p>c[“T”]: Temperature in reactor [°C]</p></li>
<li><p>c[“wf_on”]: Weighting factor for online data [dimensionless]</p></li>
<li><p>c[“wf_CO2”]: Weighting factor for CO2 data [dimensionless]</p></li>
<li><p>c[“pressure”]: Mean pressure in CO2 sensor [bar]</p></li>
</ul>
</p></li>
<li><p><strong>yields</strong> (<em>dict</em>) – Calculated yields coefficients</p></li>
<li><p><strong>kwargs_solve_ivp</strong> (<em>dict</em>) – arguments for scipy.integrate.solve_ivp, either standard or coming from the estimate function</p></li>
<li><p><strong>t_step</strong> (<em>int</em><em>, </em><em>optional</em>) – steps for given time interval if t_grid is created from an Experiment object</p></li>
<li><p><strong>endpoint</strong> (<em>str</em>) – Name of endpoint column in metadata, you may choose between different endpoints e.g. end1 and end2. Helpful if you have several endpoints in your metadata</p></li>
<li><p><strong>**kwargs_solve_ivp</strong> – <p>optional arguments for scipy.integrate.solve_ivp</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sim_exp: Simulated data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-biomoni.visualize">
<span id="biomoni-visualize-module"></span><h2>biomoni.visualize module<a class="headerlink" href="#module-biomoni.visualize" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="biomoni.visualize.visualize">
<span class="sig-prename descclassname"><span class="pre">biomoni.visualize.</span></span><span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'BASET_rate':</span> <span class="pre">'cyan',</span> <span class="pre">'CO2':</span> <span class="pre">'orange',</span> <span class="pre">'cE':</span> <span class="pre">'blue',</span> <span class="pre">'cS':</span> <span class="pre">'green',</span> <span class="pre">'cX':</span> <span class="pre">'red'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_fitted'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'markers'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lines'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secondary_y_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['CO2',</span> <span class="pre">'BASET_rate']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaxis_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sec_yaxis_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#biomoni.visualize.visualize" title="Permalink to this definition"></a></dt>
<dd><p>Function to visualize experimental data and simulated data of one experiment either alone or in conjunction. It is necessary that the experimental data and the simulated data are from the same experiment to yield meaningful results. 
The given data must be either a single pd.DataFrame: df or a list or a dict with pd.DataFrame objects, for example a dict with “off” : df1, “on” : df2 and “CO2” : df3.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_1</strong> (<em>dict</em><em>, </em><em>list</em><em>, </em><em>pd.DataFrame</em>) – Data to plot</p></li>
<li><p><strong>data_2</strong> (<em>dict</em><em>, </em><em>list</em><em>, </em><em>pd.DataFrame</em><em>, </em><em>optional</em>) – Data to plot in conjunction with data_1</p></li>
<li><p><strong>title</strong> (<em>int</em><em>, </em><em>str</em><em>, </em><em>None</em><em>, </em><em>optional</em>) – title of plot, can be str, int (for experiment number) or None</p></li>
<li><p><strong>suffix_1</strong> (<em>str</em><em>, </em><em>optional</em>) – name appendix after column name in the legend for data_1</p></li>
<li><p><strong>suffix_2</strong> (<em>str</em><em>, </em><em>optional</em>) – name appendix after column name in the legend for data_2</p></li>
<li><p><strong>mode_1</strong> (<em>str</em><em>, </em><em>optional</em>) – type of marker (e.g. “lines”, “markers” or “lines+markers” for data_1</p></li>
<li><p><strong>mode_2</strong> (<em>str</em><em>, </em><em>optional</em>) – type of marker (e.g. “lines”, “markers” or “lines+markers” for data_2</p></li>
<li><p><strong>secondary_y_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – list of column names which should be displayed on the secondary y axis</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph with plotted and named data</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-biomoni">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-biomoni" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Paul Senck.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>